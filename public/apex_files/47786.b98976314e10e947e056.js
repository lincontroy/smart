(self.webpackChunktradingview=self.webpackChunktradingview||[]).push([[47786,15483],{276536:(e,t,n)=>{"use strict";n.d(t,{DECEMBER:()=>E,FIRST_DAY_OF_WEEK:()=>v,FRIDAY:()=>h,JANUARY:()=>m,JULY:()=>T,LAST_DAY_OF_WEEK:()=>_,MARCH:()=>f,MAY:()=>p,MONDAY:()=>l,NOVEMBER:()=>b,SATURDAY:()=>d,SEPTEMBER:()=>g,SUNDAY:()=>r,THURSDAY:()=>c,TUESDAY:()=>u,WEDNESDAY:()=>a,add_date:()=>A,add_days_considering_dst:()=>O,add_minutes:()=>V,cal_to_utc:()=>G,clone:()=>F,days_per_year:()=>W,get_cal:()=>$,get_cal_from_unix_timestamp_ms:()=>j,get_cal_utc:()=>q,get_day_of_month:()=>C,get_day_of_week:()=>k,get_day_of_year:()=>P,get_days_in_month:()=>U,get_hours:()=>I,get_minutes:()=>D,get_minutes_from_midnight:()=>N,get_minutes_with_hours:()=>R,get_month:()=>L,get_timezone:()=>J,get_year:()=>S,is_leap_year:()=>Y,millisecondsPerDay:()=>w,minutesPerDay:()=>y,minutesPerWeek:()=>M,set_hms:()=>x,set_seconds:()=>H,time_seconds:()=>K,time_seconds_diff:()=>B,utc_to_cal:()=>z,utc_to_cal_ts:()=>X});var i=n(953159);const o={0:0,1:31,2:59,3:90,4:120,5:151,6:181,7:212,8:243,9:273,10:304,11:334};class s{constructor(e){this._invalid=!1,this._name=e;let t=i.tzData[e];!t&&Z&&(t=Z.instance().getTimezoneData(e)),t||(t={time:[],offset:[]},this._invalid=!0),t.time.length!==t.offset.length&&(t={time:[],offset:[]},this._invalid=!0);const n=t;if(!n.time_utc){const e=t.time,i=t.offset,o=e.length,s=new Array(o);for(let t=0;t<o;t++)e[t]*=1e3,i[t]*=1e3,s[t]=e[t]-i[t];n.time_utc=s}this.tz=n}offset_utc(e){return s.offset(this.tz.time_utc,this.tz.offset,e)}offset_loc(e){return s.offset(this.tz.time,this.tz.offset,e)}name(){return this._name}is_valid(){return!this._invalid}correction_loc(e){const t=this.tz.time,n=this.tz.offset,i=Q(t,e);if(i<1)return 0;const o=n[i]-n[i-1];if(o>0){if(e-t[i-1]<=o)return o}return 0}static offset(e,t,n){const i=Q(e,n);return-1===i?0:t[i]}}const r=1,l=2,u=3,a=4,c=5,h=6,d=7,v=r,_=d,m=0,f=2,p=4,T=6,g=8,b=10,E=11,y=1440,M=10080,w=864e5;function S(e){return e.getUTCFullYear()}function L(e){return e.getUTCMonth()}function I(e){return e.getUTCHours()}function D(e){return e.getUTCMinutes()}function C(e){return e.getUTCDate()}function k(e){return e.getUTCDay()+1}function P(e){const t=e.getUTCMonth();let n=o[t];return t>m+1&&Y(e.getUTCFullYear())&&(n+=1),n+e.getUTCDate()}function N(e){return 60*I(e)+D(e)}function R(e){return N(e)}function x(e,t,n,i,o,s){e.setUTCHours(t),e.setUTCMinutes(n),e.setUTCSeconds(i),e.setUTCMilliseconds(o),void 0!==s&&function(e,t){const n=e.getTime(),i=t.correction_loc(n);e.setTime(n+i)}(e,s)}function O(e,t,n){const i=e.offset_utc(t.getTime()),o=F(t);A(o,n);const s=e.offset_utc(o.getTime());return o.setTime(o.getTime()+i-s),o}function A(e,t){e.setTime(e.getTime()+t*w)}function V(e,t){e.setTime(e.getTime()+60*t*1e3)}function H(e,t){const n=86400,i=t%n<0?-1:0,o=Math.trunc(t/n)+i,s=t-o*n,r=Math.trunc(s/3600),l=Math.trunc(s%3600/60);x(e,r,l,s-3600*r-60*l,0),A(e,o)}function F(e){return new Date(e.getTime())}function U(e,t){let n;switch(e){case 0:case 2:case 4:case 6:case 7:case 9:case 11:n=31;break;case 1:n=28,Y(t)&&n++;break
;default:n=30}return n}function W(e){return Y(e)?366:365}function Y(e){return e%4==0&&(e%100!=0||e%400==0)}function K(e){return 1e3*e}function B(e,t){return te(e)-te(t)}function z(e,t){return new Date(X(e,t))}function X(e,t){return t+e.offset_utc(t)}function $(e,t,n,i,o,s,r){const l=new Date(Date.UTC(t,n,i,o||0,s||0,r||0)),u=e.offset_utc(+l);return new Date(l.valueOf()-u)}function j(e,t){return new Date(t+e.offset_utc(t))}function q(e,t,n,i=0,o=0,s=0){return new Date(Date.UTC(e,t,n,i,o,s))}function G(e,t,n){let i=t.getTime();n&&(i+=e.correction_loc(i));return i-e.offset_loc(i)}function J(e){return new s(e)}let Z;function Q(e,t){const n=e.length;if(0===n)return-1;if(isNaN(t))throw Error("Key is NaN");let i=0,o=n-1,s=ee((i+o)/2);for(;;){if(e[s]>t){if(o=s-1,o<i)return s}else if(i=s+1,o<i)return s<n-1?s+1:-1;s=ee((i+o)/2)}}function ee(e){return Math.trunc(e)}function te(e){return e<0?ee(e/1e3)-(e%1e3!=0?1:0):ee(e/1e3)}},564894:(e,t,n)=>{"use strict";n.d(t,{hasService:()=>u,registerService:()=>r,service:()=>a,unregisterService:()=>l,waitServiceRegistered:()=>c});var i=n(197188);const o={},s=new Map;function r(e,t){if(u(e))throw new Error("Service already registered");o[e.id]=t;const n=s.get(e.id);void 0!==n&&(s.delete(e.id),n.resolve(t))}function l(e){if(!u(e))throw new Error("Service not found");o[e.id]=void 0}function u(e){return void 0!==o[e.id]}function a(e){const t=o[e.id];if(void 0===t)throw new Error("ServiceLocator: Service "+e.id+" not found");return t}function c(e){if(u(e))return Promise.resolve(a(e));let t=s.get(e.id);return void 0===t&&(t=(0,i.createDeferredPromise)(),s.set(e.id,t)),t.promise}},72368:(e,t,n)=>{"use strict";n.d(t,{canShowNewSymbolSearch:()=>u,getCurrentLocaleInfoCountry:()=>a,isMobile:()=>r,isPlatformMobile:()=>l});var i=n(314802),o=n(687037),s=n(638456);function r(){const e=window.matchMedia("(min-width: 602px) and (min-height: 445px)").matches;return s.CheckMobile.any()&&!e}function l(){return!(0,i.isOnMobileAppPage)("any")&&r()}function u(){return!o.enabled("widget")&&!(0,i.isOnMobileAppPage)("any")}function a(){return window.initData?.currentLocaleInfo?.flag.toUpperCase()}},515828:(e,t,n)=>{"use strict";n.d(t,{MINDS_GROUP_PATH_PATTERN:()=>i,createMindsPath:()=>o});const i="/minds/groups/:symbol/";function o(e,t,n){let o=i.replace(":symbol",encodeURIComponent(e));if(!t)return o;const s=new URLSearchParams;return s.set("mind",t),n&&s.set("editable","true"),o+=`?${s.toString()}`,o}},951713:(e,t,n)=>{"use strict";n.d(t,{getHideOptions:()=>c,getSavedHideMode:()=>d,toggleHideMode:()=>h});var i=n(650151),o=n(444372),s=n(62802),r=n(514183),l=n(313344),u=n(597101);let a=null;function c(){if(null!==a)return a;const e=(0,r.tradingService)();return a=new Map([["drawings",{label:o.t(null,void 0,n(703217)),dataName:"hide-drawing-tools",tooltip:{active:o.t(null,void 0,n(185891)),inactive:o.t(null,void 0,n(752563))},getBoxedValue:()=>(0,l.hideAllDrawings)(),trackLabel:"hide drawings"}],["indicators",{label:o.t(null,void 0,n(72351)),dataName:"hide-indicators",tooltip:{active:o.t(null,void 0,n(598753)),
inactive:o.t(null,void 0,n(178525))},getBoxedValue:()=>(0,l.hideAllIndicators)(),trackLabel:"hide indicators"}],["positions",{label:o.t(null,void 0,n(492226)),dataName:"hide-positions-and-orders",tooltip:{active:o.t(null,void 0,n(420506)),inactive:o.t(null,void 0,n(842164))},getBoxedValue:()=>(0,i.ensureNotNull)(e).showTradedSources,inverted:!0,trackLabel:"hide positions"}],["all",{label:o.t(null,void 0,n(47074)),dataName:"hide-all",tooltip:{active:e?o.t(null,void 0,n(686738)):o.t(null,void 0,n(225881)),inactive:e?o.t(null,void 0,n(418216)):o.t(null,void 0,n(90763))},trackLabel:"hide all"}]]),e||a.delete("positions"),a}function h(e){e?s.setValue("ChartToolsHideMode",e):e=d();const t=v();let n=!t;return"all"===e?(_(((e,t,i)=>{e.setValue(i?!n:n)})),u.hideStateChange.fire({hideMode:e,isActive:n}),n):(_(((i,o,s)=>{if(o===e){const e=t?!s:!i.value();i.setValue(e),n=s?!e:e}else i.setValue(Boolean(s))})),u.hideStateChange.fire({hideMode:e,isActive:n}),n)}function d(){const e=s.getValue("ChartToolsHideMode","drawings");return c().has(e)?e:"drawings"}function v(){let e=!0;return _(((t,n,i)=>{const o=t.value();e=e&&(i?!o:o)})),e}function _(e){c().forEach(((t,n)=>{const i=t.getBoxedValue?.();i&&e(i,n,t.inverted)}))}},495450:(e,t,n)=>{"use strict";n.d(t,{getChartTimezoneOffsetMs:()=>s,getChartTimezoneOffsetSec:()=>r,getTimezoneName:()=>o});var i=n(276536);function o(e){const t=e.model().timezone();if("exchange"!==t)return t;const n=e.model().mainSeries().symbolInfo();return n?.timezone}function s(e,t){if(void 0===t)return 0;return(0,i.get_timezone)(t).offset_utc(e)}function r(e,t){return s(1e3*e,t)/1e3}},712474:(e,t,n)=>{"use strict";n.d(t,{getChartWidgetApiTimeConverter:()=>u});var i=n(650151),o=n(62056),s=n(687037);const r=s.enabled("end_of_period_timescale_marks"),l=s.enabled("secondary_series_extend_time_scale");function u(e,t,n){return new c(function(e,t){const n=function(e,t){return e+t.session+t.timezone+(t.corrections||"")+(t.session_holidays||"")}(e,t);let i=a.get(n);void 0===i&&(i=(0,o.createDwmAligner)(e,t),a.set(n,i));return i}(e,t),n)}const a=new Map;class c{constructor(e,t){this._dwmAligner=e,this._chartModel=t}convertPublicTimeToInternalTime(e){return null!==this._dwmAligner?this._dwmAligner.timeToSessionStart(1e3*e)/1e3:e}convertInternalTimeToPublicTime(e){return null!==this._dwmAligner?this._dwmAligner.timeToExchangeTradingDay(1e3*e)/1e3:e}convertTimePointIndexToPublicTime(e){const t=this._chartModel.timeScale();if(t.isEmpty())return null;let n=r?function(e,t){const n=e.indexToUserTime(t);if(null===n)return null;return n.getTime()/1e3}(t,e):this.convertTimePointIndexToInternalTime(e);if(null!==n){const t=this._chartModel.mainSeries().bars(),i=t.contains(e),o=t.firstIndex(),s=t.lastIndex();!i&&(null!==o&&null!==s&&o<=e&&e<=s)&&l||(n=this.convertInternalTimeToPublicTime(n))}return n}convertTimePointIndexToInternalTime(e){const t=this._chartModel.timeScale();if(t.isEmpty())return null;const n=t.points(),{firstIndex:o,lastIndex:s}=(0,i.ensureNotNull)(n.range().value());let r=null
;if(o<=e&&e<=s)r=n.valueAt(e);else if(e>s){const n=this._chartModel.mainSeries().syncModel();if(null!==n){const o=(0,i.ensureNotNull)(t.indexToTimePoint(s));r=n.projectTime(o,e-s)}}return r}}},853290:(e,t,n)=>{"use strict";n.r(t),n.d(t,{MouseEventHandler:()=>f,defaultPreventedHandler:()=>_,getClickPosition:()=>d,ignoreClickOrTapOnDblClickOrDblTapHandlers:()=>m,isTouchMouseEvent:()=>v});var i=n(481251),o=n(650151),s=n(536794),r=n(638456),l=n(196726),u=n(793750);let a=2;const c=r.isSafari?"click":"auxclick",h={treatVertTouchDragAsPageScroll:!1,treatHorzTouchDragAsPageScroll:!1,ignoreClickAndTapOnDblClickOrDblTap:!1};function d(e){if(v(e))return{x:e.clientX,y:e.clientY};if("touches"in(t=e)&&void 0!==t.touches){if(1===e.touches.length){const t=(0,o.ensureNotNull)(e.target).getBoundingClientRect(),n=e.touches[0];return{x:n.clientX-t.left,y:n.clientY-t.top}}return null}var t;return{x:e.offsetX,y:e.offsetY}}function v(e){return"isTouch"in e&&"stylus"in e}function _(e){return t=>{t.preventDefault(),e(t)}}function m(e,t){let n=!1;return{clickOrTap:(...i)=>{t?.()?e.clickOrTap(...i):(n=!1,setTimeout((()=>!n&&e.clickOrTap(...i)),501))},doubleClickOrDoubleTap:(...t)=>{n=!0,e.doubleClickOrDoubleTap?.(...t)}}}class f{constructor(e,t,n){if(this._clickCount=0,this._clickTimeoutId=null,this._clickPosition={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY},this._tapCount=0,this._tapTimeoutId=null,this._tapPosition={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY},this._longTapTimeoutId=null,this._longTapActive=!1,this._mouseMoveStartPosition=null,this._touchMoveStartPosition=null,this._touchMoveExceededManhattanDistance=!1,this._cancelClick=!1,this._cancelTap=!1,this._unsubscribeOutsideMouseEvents=null,this._unsubscribeOutsideTouchEvents=null,this._unsubscribeMobileSafariEvents=null,this._unsubscribeMousemove=null,this._unsubscribeRootMouseEvents=null,this._unsubscribeRootTouchEvents=null,this._unsubscribePinchEvents=null,this._unsubscribeTargetElementEvents=null,this._pinchInfo=null,this._pinchPrevented=!1,this._preventTouchDragProcess=!1,this._mousePressed=!1,this._lastTouchEventTimeStamp=0,this._activeTouchId=null,this._acceptMouseLeave=!r.CheckMobile.iOS(),this._onFirefoxOutsideMouseUp=e=>{this._mouseUpHandler(e)},this._onMobileSafariDoubleClick=e=>{if(this._firesTouchEvents(e)){const t=this._makeCompatEvent(e);if(++this._tapCount,this._tapTimeoutId&&this._tapCount>1){const{manhattanDistance:n}=this._touchMouseMoveWithDownInfo(T(e),this._tapPosition);n<30&&!this._cancelTap&&this._processTouchEvent(t,this._handlers.doubleTapEvent),this._resetTapTimeout()}}else{const t=this._makeCompatEvent(e);if(++this._clickCount,this._clickTimeoutId&&this._clickCount>1){const{manhattanDistance:n}=this._touchMouseMoveWithDownInfo(T(e),this._clickPosition);n<5&&!this._cancelClick&&this._processMouseEvent(t,this._handlers.mouseDoubleClickEvent),this._resetClickTimeout()}}},this._target=e,this._options=(0,s.merge)((0,s.clone)(h),n||{}),this._options.ignoreClickAndTapOnDblClickOrDblTap){if(t.mouseClickEvent&&t.mouseDoubleClickEvent){
const e=m({clickOrTap:t.mouseClickEvent.bind(t),doubleClickOrDoubleTap:t.mouseDoubleClickEvent.bind(t)});t.mouseClickEvent=e.clickOrTap,t.mouseDoubleClickEvent=e.doubleClickOrDoubleTap}if(t.tapEvent&&t.doubleTapEvent){const e=m({clickOrTap:t.tapEvent.bind(t),doubleClickOrDoubleTap:t.doubleTapEvent.bind(t)});t.tapEvent=e.clickOrTap,t.doubleTapEvent=e.doubleClickOrDoubleTap}}this._handlers=t,this._init()}destroy(){null!==this._unsubscribeOutsideMouseEvents&&(this._unsubscribeOutsideMouseEvents(),this._unsubscribeOutsideMouseEvents=null),null!==this._unsubscribeOutsideTouchEvents&&(this._unsubscribeOutsideTouchEvents(),this._unsubscribeOutsideTouchEvents=null),null!==this._unsubscribeMousemove&&(this._unsubscribeMousemove(),this._unsubscribeMousemove=null),null!==this._unsubscribeRootMouseEvents&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null),null!==this._unsubscribeRootTouchEvents&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null),null!==this._unsubscribeMobileSafariEvents&&(this._unsubscribeMobileSafariEvents(),this._unsubscribeMobileSafariEvents=null),null!==this._unsubscribePinchEvents&&(this._unsubscribePinchEvents(),this._unsubscribePinchEvents=null),null!==this._unsubscribeTargetElementEvents&&(this._unsubscribeTargetElementEvents(),this._unsubscribeTargetElementEvents=null),this._clearLongTapTimeout(),this._resetClickTimeout()}_mouseEnterHandler(e){this._unsubscribeMousemove&&this._unsubscribeMousemove();const t=this._mouseMoveHandler.bind(this);if(this._unsubscribeMousemove=()=>{this._target.removeEventListener("mousemove",t)},this._target.addEventListener("mousemove",t),this._firesTouchEvents(e))return;const n=this._makeCompatEvent(e);this._processMouseEvent(n,this._handlers.mouseEnterEvent),this._acceptMouseLeave=!0}_resetClickTimeout(){null!==this._clickTimeoutId&&clearTimeout(this._clickTimeoutId),this._clickCount=0,this._clickTimeoutId=null,this._clickPosition={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY}}_resetTapTimeout(){null!==this._tapTimeoutId&&clearTimeout(this._tapTimeoutId),this._tapCount=0,this._tapTimeoutId=null,this._tapPosition={x:Number.NEGATIVE_INFINITY,y:Number.POSITIVE_INFINITY}}_mouseMoveHandler(e){if(this._mousePressed||null!==this._touchMoveStartPosition)return;if(this._firesTouchEvents(e))return;const t=this._makeCompatEvent(e);this._processMouseEvent(t,this._handlers.mouseMoveEvent),this._acceptMouseLeave=!0}_touchMoveHandler(e){const t=E(e.changedTouches,(0,o.ensureNotNull)(this._activeTouchId));if(null===t)return;if(this._lastTouchEventTimeStamp=b(e),null!==this._pinchInfo)return;if(this._preventTouchDragProcess)return;this._pinchPrevented=!0;const n=this._touchMouseMoveWithDownInfo(T(t),(0,o.ensureNotNull)(this._touchMoveStartPosition)),{xOffset:i,yOffset:s,manhattanDistance:r}=n;if(this._touchMoveExceededManhattanDistance||!(r<5)){if(!this._touchMoveExceededManhattanDistance){
const e=.5*i,t=this._options.shouldAllowTouchDrag?.()??!1,n=s>=e&&(!this._options.treatVertTouchDragAsPageScroll||t),o=e>s&&(!this._options.treatHorzTouchDragAsPageScroll||t);n||o||(this._preventTouchDragProcess=!0),this._touchMoveExceededManhattanDistance=!0,this._cancelTap=!0,this._clearLongTapTimeout(),this._resetTapTimeout()}if(!this._preventTouchDragProcess){const n=this._makeCompatEvent(e,t);this._processTouchEvent(n,this._handlers.touchMoveEvent),(0,l.preventDefault)(e)}}}_mouseMoveWithDownHandler(e){if(0!==e.button)return;const t=this._touchMouseMoveWithDownInfo(T(e),(0,o.ensureNotNull)(this._mouseMoveStartPosition)),{manhattanDistance:n}=t;if(n>=5&&(this._cancelClick=!0,this._resetClickTimeout()),this._cancelClick){const t=this._makeCompatEvent(e);this._processMouseEvent(t,this._handlers.pressedMouseMoveEvent)}}_touchMouseMoveWithDownInfo(e,t){const n=Math.abs(t.x-e.x),i=Math.abs(t.y-e.y);return{xOffset:n,yOffset:i,manhattanDistance:n+i}}_touchEndHandler(e){let t=E(e.changedTouches,(0,o.ensureNotNull)(this._activeTouchId));if(null===t&&0===e.touches.length&&(t=e.changedTouches[0]),null===t)return;this._activeTouchId=null,this._lastTouchEventTimeStamp=b(e),this._clearLongTapTimeout(),this._touchMoveStartPosition=null,this._unsubscribeRootTouchEvents&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null);const n=this._makeCompatEvent(e,t);if(this._processTouchEvent(n,this._handlers.touchEndEvent),++this._tapCount,this._tapTimeoutId&&this._tapCount>1){const{manhattanDistance:e}=this._touchMouseMoveWithDownInfo(T(t),this._tapPosition);e<30&&!this._cancelTap&&this._processTouchEvent(n,this._handlers.doubleTapEvent),this._resetTapTimeout()}else this._cancelTap||(this._processTouchEvent(n,this._handlers.tapEvent),this._handlers.tapEvent&&(0,l.preventDefault)(e));0===this._tapCount&&(0,l.preventDefault)(e),0===e.touches.length&&this._longTapActive&&(this._longTapActive=!1,(0,l.preventDefault)(e))}_touchCancelHandler(e){this._touchEndHandler(e)}_mouseUpHandler(e){if(0!==e.button)return;const t=this._makeCompatEvent(e);if(this._mouseMoveStartPosition=null,this._mousePressed=!1,this._unsubscribeRootMouseEvents&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null),r.isFF){this._target.ownerDocument.documentElement.removeEventListener("mouseleave",this._onFirefoxOutsideMouseUp)}if(!this._firesTouchEvents(e))if(this._processMouseEvent(t,this._handlers.mouseUpEvent),++this._clickCount,this._clickTimeoutId&&this._clickCount>1){const{manhattanDistance:n}=this._touchMouseMoveWithDownInfo(T(e),this._clickPosition);n<5&&!this._cancelClick&&this._processMouseEvent(t,this._handlers.mouseDoubleClickEvent),this._resetClickTimeout()}else this._cancelClick||this._processMouseEvent(t,this._handlers.mouseClickEvent)}_clearLongTapTimeout(){null!==this._longTapTimeoutId&&(clearTimeout(this._longTapTimeoutId),this._longTapTimeoutId=null)}_touchStartHandler(e){if(null!==this._activeTouchId)return this._clearLongTapTimeout(),void this._resetTapTimeout();const t=e.changedTouches[0]
;this._activeTouchId=t.identifier,this._lastTouchEventTimeStamp=b(e);const n=this._target.ownerDocument.documentElement;this._cancelTap=!1,this._touchMoveExceededManhattanDistance=!1,this._preventTouchDragProcess=!1,this._touchMoveStartPosition=T(t),this._unsubscribeRootTouchEvents&&(this._unsubscribeRootTouchEvents(),this._unsubscribeRootTouchEvents=null);{const t=this._touchMoveHandler.bind(this),i=this._touchEndHandler.bind(this);this._unsubscribeRootTouchEvents=()=>{n.removeEventListener("touchmove",t),n.removeEventListener("touchend",i)},n.addEventListener("touchmove",t,{passive:!1}),n.addEventListener("touchend",i,{passive:!1}),this._clearLongTapTimeout(),this._longTapTimeoutId=setTimeout(this._longTapHandler.bind(this,e),333)}const i=this._makeCompatEvent(e,t);this._processTouchEvent(i,this._handlers.touchStartEvent),this._tapTimeoutId||(this._tapCount=0,this._tapTimeoutId=setTimeout(this._resetTapTimeout.bind(this),500),this._tapPosition=T(t))}_wheelClickHandler(e){if(1!==e.button)return;if(this._firesTouchEvents(e))return;const t=this._makeCompatEvent(e);this._processMouseEvent(t,this._handlers.wheelClickEvent)}_mouseDownHandler(e){if(0!==e.button)return;const t=this._target.ownerDocument.documentElement;r.isFF&&t.addEventListener("mouseleave",this._onFirefoxOutsideMouseUp),this._cancelClick=!1,this._mouseMoveStartPosition=T(e),this._unsubscribeRootMouseEvents&&(this._unsubscribeRootMouseEvents(),this._unsubscribeRootMouseEvents=null);{const e=this._mouseMoveWithDownHandler.bind(this),n=this._mouseUpHandler.bind(this);this._unsubscribeRootMouseEvents=()=>{t.removeEventListener("mousemove",e),t.removeEventListener("mouseup",n)},t.addEventListener("mousemove",e),t.addEventListener("mouseup",n)}if(this._mousePressed=!0,this._firesTouchEvents(e))return;const n=this._makeCompatEvent(e);this._processMouseEvent(n,this._handlers.mouseDownEvent),this._clickTimeoutId||(this._clickCount=0,this._clickTimeoutId=setTimeout(this._resetClickTimeout.bind(this),500),this._clickPosition=T(e))}_init(){const e=this._mouseEnterHandler.bind(this);this._target.addEventListener("mouseenter",e);const t=this._touchCancelHandler.bind(this);this._target.addEventListener("touchcancel",t);{const e=this._target.ownerDocument,t=e=>!e.target||!this._target.contains(e.target),n=e=>{if(!t(e))return;const n=e.changedTouches[0];this._lastTouchEventTimeStamp=b(e),this._processTouchEvent(this._makeCompatEvent(e,n),this._handlers.touchStartOutsideEvent)},i=e=>{t(e)&&!this._firesTouchEvents(e)&&this._processMouseEvent(this._makeCompatEvent(e),this._handlers.mouseDownOutsideEvent)};this._unsubscribeOutsideTouchEvents=()=>{e.removeEventListener("touchstart",n)},this._unsubscribeOutsideMouseEvents=()=>{e.removeEventListener("mousedown",i)},e.addEventListener("mousedown",i),e.addEventListener("touchstart",n,{passive:!0})}r.CheckMobile.iOS()&&(this._unsubscribeMobileSafariEvents=()=>{this._target.removeEventListener("dblclick",this._onMobileSafariDoubleClick)},this._target.addEventListener("dblclick",this._onMobileSafariDoubleClick))
;const n=this._mouseLeaveHandler.bind(this);this._target.addEventListener("mouseleave",n);const i=this._contextMenuHandler.bind(this);this._target.addEventListener("contextmenu",i);const o=this._touchStartHandler.bind(this);let s;this._target.addEventListener("touchstart",o,{passive:!0}),r.isChrome&&(s=e=>{if(1===e.button)return e.preventDefault(),!1},this._target.addEventListener("mousedown",s));const l=this._mouseDownHandler.bind(this);this._target.addEventListener("mousedown",l);const u=this._wheelClickHandler.bind(this);this._target.addEventListener(c,u);const a=()=>{};this._target.addEventListener("touchmove",a,{passive:!1}),this._unsubscribeTargetElementEvents=()=>{this._target.removeEventListener("mouseleave",n),this._target.removeEventListener("contextmenu",i),this._target.removeEventListener("touchstart",o),s&&this._target.removeEventListener("mousedown",s),this._target.removeEventListener("mousedown",l),this._target.removeEventListener(c,u),this._target.removeEventListener("touchmove",a)},this._initPinch()}_initPinch(){if(void 0===this._handlers.pinchStartEvent&&void 0===this._handlers.pinchEvent&&void 0===this._handlers.pinchEndEvent)return;const e=e=>this._checkPinchState(e.touches);this._target.addEventListener("touchstart",e,{passive:!0});const t=e=>{if(null===this._pinchInfo)return;const t=E(e.touches,(0,o.ensureNotNull)(this._activeTouchId)),n=E(e.touches,this._pinchInfo.secondTouchId);if(t&&n&&void 0!==this._handlers.pinchEvent){const{startPinchDistance:i,startPinchMiddlePoint:o}=this._pinchInfo,s=g(t,n)/i,r=p(this._target);this._handlers.pinchEvent(o,{x:t.clientX-r.left,y:t.clientY-r.top},{x:n.clientX-r.left,y:n.clientY-r.top},s),(0,l.preventDefault)(e)}};this._target.addEventListener("touchmove",t,{passive:!1});const n=e=>this._checkPinchState(e.touches);this._target.addEventListener("touchend",n),this._unsubscribePinchEvents=()=>{this._target.removeEventListener("touchstart",e),this._target.removeEventListener("touchmove",t),this._target.addEventListener("touchend",n)}}_checkPinchState(e){1===e.length&&(this._pinchPrevented=!1),2!==e.length||this._pinchPrevented||this._longTapActive?this._stopPinch():this._startPinch(e)}_startPinch(e){if(void 0!==this._handlers.pinchStartEvent&&null===this._pinchInfo){const t=p(this._target);let n,i;e[0].identifier===this._activeTouchId?(n=e[0],i=e[1]):(n=e[1],i=e[0]);const o={x:n.clientX-t.left,y:n.clientY-t.top},s={x:i.clientX-t.left,y:i.clientY-t.top},r={x:(o.x+s.x)/2,y:(o.y+s.y)/2};this._handlers.pinchStartEvent(r,o,s,{bothPointsOnTargetElement:this._target.contains(i.target)})&&(this._pinchInfo={startPinchDistance:g(n,i),startPinchMiddlePoint:r,secondTouchId:i.identifier})}this._clearLongTapTimeout()}_stopPinch(){null!==this._pinchInfo&&(this._pinchInfo=null,this._handlers.pinchEndEvent?.())}_mouseLeaveHandler(e){if(this._unsubscribeMousemove&&this._unsubscribeMousemove(),this._firesTouchEvents(e))return;if(!this._acceptMouseLeave)return;const t=this._makeCompatEvent(e);this._processMouseEvent(t,this._handlers.mouseLeaveEvent),
this._acceptMouseLeave=!r.CheckMobile.iOS()}_longTapHandler(e){const t=E(e.touches,(0,o.ensureNotNull)(this._activeTouchId));if(null===t)return;const n=this._makeCompatEvent(e,t);this._processTouchEvent(n,this._handlers.longTapEvent),this._processTouchEvent(n,this._handlers.touchContextMenuEvent),this._cancelTap=!0,this._longTapActive=!0}_contextMenuHandler(e){if((0,l.preventDefault)(e),null!==this._touchMoveStartPosition)return;if(this._firesTouchEvents(e))return;const t=this._makeCompatEvent(e);this._processMouseEvent(t,this._handlers.contextMenuEvent),this._cancelClick=!0}_firesTouchEvents(e){return e.sourceCapabilities&&void 0!==e.sourceCapabilities.firesTouchEvents?e.sourceCapabilities.firesTouchEvents:b(e)<this._lastTouchEventTimeStamp+500}_processTouchEvent(e,t){(0,u.setLastMouseOrTouchEventInfo)(e),t&&t.call(this._handlers,e)}_processMouseEvent(e,t){window.TVD&&("mouseenter"===e.srcType||"mousemove"===e.srcType)&&a>0?a--:("mouseleave"!==e.srcType&&(0,u.setLastMouseOrTouchEventInfo)(e),t&&t.call(this._handlers,e))}_makeCompatEvent(e,t){const n=t||e,o=t?void 0:e.buttons,s=(0,i.default)((()=>this._target.getBoundingClientRect()||{left:0,top:0}));return{clientX:n.clientX,clientY:n.clientY,pageX:n.pageX,pageY:n.pageY,screenX:n.screenX,screenY:n.screenY,get localX(){return n.clientX-s().left},get localY(){return n.clientY-s().top},ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,metaKey:e.metaKey,buttons:o,isTouch:!e.type.startsWith("mouse")&&"contextmenu"!==e.type&&"click"!==e.type,stylus:"stylus"===t?.touchType,srcType:e.type,target:n.target,view:e.view,preventDefault:()=>{"touchstart"!==e.type&&(0,l.preventDefault)(e)}}}}function p(e){return e.getBoundingClientRect()||{left:0,top:0}}function T(e){return{x:e.pageX,y:e.pageY}}function g(e,t){const n=e.clientX-t.clientX,i=e.clientY-t.clientY;return Math.sqrt(n*n+i*i)}function b(e){return e.timeStamp||performance.now()}function E(e,t){for(let n=0;n<e.length;++n)if(e[n].identifier===t)return e[n];return null}},800686:(e,t,n)=>{"use strict";n.r(t),n.d(t,{addSymbolDialogHasOpenedKey:()=>r,showAddSymbolDialog:()=>l});var i=n(975810),o=n(305514),s=n(251954);const r="addSymbolDialogHasOpenedKey";function l(e){(0,i.runOrSigninWithFeature)((()=>{(0,o.showWatchListsDialog)({addSymbols:e,onOpen:u})}),{feature:"watchList",source:"add symbol to watchlist"})}function u(){s.emit(r)}},62056:(e,t,n)=>{"use strict";n.d(t,{createDwmAligner:()=>r,createTimeToBarTimeAligner:()=>l});var i=n(150112),o=n(687037);function s(){return!o.enabled("disable_resolution_rebuild")}const r=i.createDwmAligner.bind(null,s()),l=i.createTimeToBarTimeAligner.bind(null,s())},313344:(e,t,n)=>{"use strict";n.r(t),n.d(t,{SelectPointMode:()=>i,activePointSelectionMode:()=>J,alignTo45Degrees:()=>Ie,barTimesUnderCursor:()=>Q,beenSetLineToolLastPoint:()=>H,cancelLineTool:()=>oe,cancelledLineTool:()=>V,changeLineStyle:()=>_e,changeLineTool:()=>ce,changedLineStyle:()=>$,changedLineTool:()=>K,continueLineTool:()=>ie,continuedLineTool:()=>A,copiedLineTool:()=>j,copyLineTool:()=>me,createLineTool:()=>ne,
createdLineTool:()=>O,crosshairLock:()=>S,cursorTool:()=>k,drawOnAllCharts:()=>De,drawOnAllChartsMode:()=>Ce,emojiTool:()=>D,finishChangingLineTool:()=>he,finishLineTool:()=>ve,finishMovingLineTool:()=>ue,finishedChangingLineTool:()=>B,finishedLineTool:()=>X,finishedMovingLineTool:()=>W,hideAllDrawings:()=>Me,hideAllIndicators:()=>we,hideMarksOnBars:()=>Le,iconTool:()=>I,init:()=>be,isDirectionalMovementActive:()=>x,isStudyEditingNow:()=>Z,isToolCreatingNow:()=>P,isToolEditingNow:()=>N,isToolMovingNow:()=>R,lockDrawings:()=>Se,moveLineTool:()=>le,movedLineTool:()=>U,properties:()=>ye,removeLineTool:()=>de,removedLineTool:()=>z,resetToCursor:()=>T,restoreLineTool:()=>fe,restoreLineToolState:()=>pe,restoredLineTool:()=>q,restoredLineToolState:()=>G,runOnDrawingStateReady:()=>Ee,setLineToolLastPoint:()=>se,startChangingLineTool:()=>ae,startMovingLineTool:()=>re,startedChangingLineTool:()=>Y,startedMovingLineTool:()=>F,stickerTool:()=>C,tool:()=>L,toolIsCursor:()=>_,toolIsDemonstration:()=>f,toolIsEraser:()=>m,toolIsMeasure:()=>p});var i,o=n(650151),s=n(673378),r=n(294721),l=n(77294),u=n(817585),a=n(251924),c=n(62802),h=n(251954),d=n(345848);!function(e){e[e.None=0]="None",e[e.Replay=1]="Replay",e[e.Study=2]="Study"}(i||(i={}));const v=new Set(["cursor","arrow","dot","performance","demonstration"]);function _(e){return v.has(e)}function m(e){return"eraser"===e}function f(e){return"demonstration"===e}function p(e){return"measure"===e}function T(e=!1){if(!e&&g){if(g.childs().stayInDrawingMode.value())return}L.setValue(k.value())}let g=null,b=null,E=null,y=null,M=null,w=null;const S=new u.WatchedObject(null),L=new l.WatchedValue,I=new l.WatchedValue,D=new l.WatchedValue,C=new l.WatchedValue,k=new l.WatchedValue,P=new l.WatchedValue(!1),N=new l.WatchedValue(!1),R=new l.WatchedValue(!1),x=new l.WatchedValue(!1),O=new a.Delegate,A=new a.Delegate,V=new a.Delegate,H=new a.Delegate,F=new a.Delegate,U=new a.Delegate,W=new a.Delegate,Y=new a.Delegate,K=new a.Delegate,B=new a.Delegate,z=new a.Delegate,X=new a.Delegate,$=new a.Delegate,j=new a.Delegate,q=new a.Delegate,G=new a.Delegate,J=new l.WatchedValue(i.None),Z=new l.WatchedValue(!1),Q=new Map;function ee(e,t){const n=t||{value:!1};return t=>{n.value||(n.value=!0,e.fire(t),n.value=!1)}}const te={value:!1},ne=ee(O,te),ie=ee(A,te),oe=ee(V,te),se=ee(H,te),re=ee(F),le=ee(U),ue=ee(W),ae=ee(Y),ce=ee(K),he=ee(B),de=ee(z),ve=ee(X),_e=ee($,te),me=ee(j,te),fe=ee(q),pe=ee(G);let Te=!1,ge=[];function be(){if(Te)return;const e=c.getValue("chart.cursorPreference","cursor");L.setValue(_(e)?e:"cursor"),L.subscribe((e=>{_(e)?k.setValue(e):m(e)&&(0,d.trackEvent)("Chart cursors",e)}),{callWithLast:!0}),k.subscribe((e=>{(0,d.trackEvent)("Chart cursors",e),e&&"performance"!==e&&!f(e)&&c.setValue("chart.cursorPreference",e)})),g=new r.DefaultProperty({defaultName:"drawings"}),b=(0,s.createPrimitiveProperty)(!1),E=(0,s.createPrimitiveProperty)(!1),y=(0,s.createPrimitiveProperty)(!1),M=(0,s.createPrimitiveProperty)(!c.getBool("BarsMarksContainer.visibile",!0)),w=(0,s.createPrimitiveProperty)(!1),
L.subscribe((e=>{(0,h.emit)("onSelectedLineToolChanged")})),Te=!0,ge.forEach((e=>e())),ge=[]}function Ee(e){Te?e():ge.push(e)}function ye(){return(0,o.ensureNotNull)(g)}function Me(){return(0,o.ensureNotNull)(b)}function we(){return(0,o.ensureNotNull)(E)}function Se(){return(0,o.ensureNotNull)(y)}function Le(){return(0,o.ensureNotNull)(M)}function Ie(){return(0,o.ensureNotNull)(w)}function De(){return ye().childs().drawOnAllCharts}function Ce(){return ye().childs().drawOnAllChartsMode}},129303:(e,t,n)=>{"use strict";n.d(t,{DEFAULT_ADJUSTMENT:()=>s,DEFAULT_SESSION:()=>o,DEFAULT_SETTLEMENT_AS_CLOSE:()=>r,compareSymbols:()=>b,decodeExtendedSymbol:()=>f,encodeExtendedSymbolOrGetSimpleSymbolString:()=>v,extractExtendedSymbol:()=>T,getExtendedSymbol:()=>m,isEncodedExtendedSymbol:()=>_,isReplaySymbol:()=>d,isStudySymbol:()=>c,replaceExtendedSymbol:()=>E,symbolWithoutPrefix:()=>y,unwrapSimpleSymbol:()=>p});var i=n(536794);const o="regular",s="splits",r=!0;function l(e){return"="+JSON.stringify(u(e))}function u(e){return Object.keys(e).sort().reduce(((t,n)=>("[object Object]"===Object.prototype.toString.call(e[n])?t[n]=u(e[n]):t[n]=e[n],t)),{})}function a(e){return(0,i.isString)(e)}function c(e){return!a(e)&&"inputs"in e}function h(e){return!a(e)&&"replay"in e}function d(e){return h(e)||function(e){return!a(e)&&h(e.symbol)}(e)}function v(e){return c(e)||d(e)||e.session||e.adjustment||e["currency-id"]||e["unit-id"]?l(e):e.symbol}function _(e){return"="===e[0]}function m(e){return a(e)?f(e):e}function f(e){if(!_(e))return{symbol:e};try{return JSON.parse(e.slice(1))}catch(t){return{symbol:e}}}function p(e){return a(e)?e:p(e.symbol)}function T(e){if(a(e))return{symbol:e};let t=e;for(;!a(t.symbol);)t=t.symbol;return t}const g=["symbol","session","unit-id","currency-id","adjustment","backadjustment","settlement-as-close"];function b(e,t){return g.every((n=>e[n]===t[n]))}function E(e,t){let n=e;for(;!a(n.symbol);)n=n.symbol;n.symbol=t}function y(e){return e.split(":").slice(-1).pop()??e}},478481:(e,t,n)=>{"use strict";n.d(t,{LineToolCollectedProperty:()=>a,LineToolColorsProperty:()=>h,LineToolWidthsProperty:()=>c,MultipleLineColorsProperty:()=>_,MultipleLineWidthsProperty:()=>v});var i=n(735566),o=n(483102),s=n(57408);const r=(0,i.getLogger)("Chart.LineToolCollectedProperty");class l{applyValue(e,t){e.setValue(t)}}class u extends s.PropertyBase{constructor(e,t){super(),this._properties=e,e.forEach(((e,t)=>e.subscribe(this,((e,n)=>{this._listeners.fire(this,`${t}.${n}`)})))),this._showIfProperty=t}visible(){return!this._showIfProperty||this._showIfProperty?.value()}value(){if(0===this._properties.length)return r.logError("Incorrect call, should not request value of 0 properties"),"mixed";const e=this._properties[0].value();return 1===this._properties.length||this._properties.every((t=>t.value()===e))?e:"mixed"}setValueSilently(e){"mixed"!==e&&this._properties.forEach((t=>t.setValueSilently(e)))}hasChild(e){const t=parseInt(e,10);return!isNaN(t)&&t>=0&&t<this._properties.length}childCount(){return this._properties.length}childNames(){
return this._properties.map(((e,t)=>t.toString()))}child(e){const t=parseInt(e,10);return!isNaN(t)&&t>=0&&t<this._properties.length?this._properties[t]:void 0}destroy(){this._properties.forEach((e=>e.unsubscribeAll(this))),this._listeners.destroy()}storeStateIfUndefined(){return!0}weakReference(){return(0,o.weakReference)(this)}ownership(){return(0,o.ownership)(this)}}class a extends u{setValue(e,t,n){if("mixed"===e)return;const i=n??new l;this._properties.forEach((t=>i.applyValue(t,e)))}}class c extends a{}class h extends a{firstColor(){return this._properties[0].value()}}class d extends(25242==n.j?u:null){setValue(e,t,n){if("mixed"===e)return;const i=n??new l;this._properties.forEach((t=>t.setValue(e,void 0,i)))}}class v extends(25242==n.j?d:null){}class _ extends(25242==n.j?d:null){}},703706:(e,t,n)=>{"use strict";n.d(t,{cloneLineTool:()=>H,createLineTool:()=>D,createLineToolProperties:()=>k,createStudyLineToolProperties:()=>P,ensureAllLineToolsLoadedForLayout:()=>L,initAllLineToolsFromContent:()=>I,initLineTool:()=>y,isBrushBasedLineTool:()=>R,isEditableTextLineTool:()=>A,isLineTool:()=>p.isLineTool,isTrading:()=>x,prepareLineToolPropertiesByOwnerSource:()=>C,setNewToolProperties:()=>b,supportsPhantomMode:()=>N,tryFindStudyLineToolNameByStudyId:()=>V,unsetNewToolProperties:()=>E});var i=n(182433),o=n(650151),s=n(610555),r=n(735566),l=n(507083),u=n(246239),a=n(104779),c=n(772717),h=n(233818),d=n(323348),v=n(584878),_=n(147582),m=n(81747),f=n(150199),p=n(453751);const T="DrawingCreations";let g=null;function b(e,t,n){return null!==g&&g.tool===e&&g.toolData===t||(E(!0),g={properties:k(n.backgroundTheme().spawnOwnership(),e,!n.readOnly()),tool:e,toolData:t}),g.properties}function E(e){e&&g?.properties.destroy(),g=null}async function y(e){await(0,f.loadMetaInfoForLinetoolIfRequired)(e);const t=(0,f.asLineToolName)(e);(0,f.isLineToolLoaded)(t)||(0,c.isLineToolName)(t)&&await(0,f.loadLineTool)(t)}function M(e,t){const n="charts"in e?e.charts:[e];for(const e of n){for(const n of e.panes)for(const e of n.sources)t(e.type);e.lineToolsGroups?.groups.forEach((e=>{e.tools.forEach((e=>t(e)))}))}}class w extends Error{constructor(e,t){super(`Failed to load line tool: ${e}`),this.name="LineToolLoadError",this.toolName=e,this.originalError=t}}const S=(0,r.getLogger)("LineToolsSynchronizer");async function L(e){const t=new Set,n=e=>{(0,f.isAsyncGenericLineToolName)(e)&&t.add(e)};for(const t of e)M(t,n);const i=[...t],o=(await Promise.allSettled(i.map((e=>(0,f.ensureLineToolLoaded)(e).catch((t=>{throw new w(e,t)})))))).filter((e=>"rejected"===e.status));o.length>0&&o.forEach((e=>{const t=e.reason;S.logError(`Failed to load line tool: ${t.toolName}`)}))}async function I(e){if(!e)return;const t=new Set;M(e,(e=>{(0,c.isLineToolName)(e)&&t.add(e)})),await Promise.all(Array.from(t).map((e=>y(e))))}function D(e,t,n,i,s,r,l){(0,o.assert)((0,c.isLineToolName)(e),"Unknown line tool: "+e);const u=(0,f.asLineToolName)(e);let a;if((0,o.assert)((0,f.isLineToolLoaded)(u),`Line tool ${u} is not loaded`),
s||n||null===g||g.tool!==e||(n=g.properties,E(!1)),(0,f.isAsyncStudyLineToolName)(u)){a=new((0,f.getLoadedLineTool)(u))(t,n,(0,o.ensureDefined)(i),s,r)}else{a=new((0,f.getLoadedLineTool)(u))(t,n,s,r)}return a.toolname=e,E(!0),void 0!==l&&(0,v.shouldAffectUser)(T,_.sparseUsersTrackingCoefficient)&&(0,d.trackChartDrawingCreation)(e,l),a}function C(e,t){const n=(0,o.ensureNotNull)(t.symbolSource()),i=n.symbolInfo(),s=i?(0,a.extractLineToolSymbolFromSymbolInfo)(i,n.symbol()):n.symbol();e.childs().symbol.setValue(s),n.model().currencyConversionEnabled()&&n.isConvertedToOtherCurrency()&&e.childs().currencyId.setValue(n.currency()),n.model().unitConversionEnabled()&&n.isConvertedToOtherUnit()&&e.childs().unitId.setValue(n.unit()),e.childs().symbolStateVersion.setValue(2),e.childs().zOrderVersion.setValue(2)}function k(e,t,n,i){(0,o.assert)((0,c.isLineToolName)(t),`${t} should be name of the line tool`);const s=(0,f.asLineToolName)(t);if((0,o.assert)((0,f.isLineToolLoaded)(s),`Line tool ${s} is not loaded`),(0,f.isAsyncStudyLineToolName)(s)){return(0,f.getLoadedLineTool)(s).createProperties(e,i)}return(0,f.getLoadedLineTool)(s).createProperties(e,i,n)}function P(e,t,n,i,s,r){(0,o.assert)((0,c.isStudyLineToolName)(t),`${t} should be name of the study line tool`);const l=(0,f.asLineToolName)(t);if((0,f.isAsyncStudyLineToolName)(l)){return(0,f.getLoadedLineTool)(l).createPropertiesFromStudyMetaInfoAndState(n,i,s,r,e)}throw new Error(`Property creation is not implemented for study line tool ${t}`)}function N(e){(0,o.assert)((0,c.isLineToolName)(e),`${e} should be name of the line tool`);const t=(0,f.asLineToolName)(e);(0,o.assert)((0,f.isLineToolLoaded)(t),`Line tool ${t} is not loaded`);const n=(0,f.getLoadedLineTool)(t);return void 0!==n&&Boolean(n.supportPhantomMode)}function R(e){return e instanceof m.LineToolBrushBase}function x(e){return e instanceof u.LineToolTrading}const O=["editableTextStyle","editableText","editableTextProperties"];function A(e){return(0,i.default)(e)&&O.every((t=>t in e))}function V(e){let t=null;return e===h.lineToolsStudyIds.LineToolRegressionTrend?t="LineToolRegressionTrend":e===h.lineToolsStudyIds.LineToolVbPFixed?t="LineToolVbPFixed":e===h.lineToolsStudyIds.LineToolFixedRangeVolumeProfile&&(t="LineToolFixedRangeVolumeProfile"),t}function H(e,t,n,i,r){const u=t.toolname,a=t.properties().state();a.intervalsVisibilities=(0,l.mergeIntervalVisibilitiesDefaults)(a?.intervalsVisibilities);const c=k(e.backgroundTheme().spawnOwnership(),t.toolname,!e.readOnly(),a);c.childs().visible.setValue(!0);const h=(0,o.ensureNotNull)(t.ownerSource()),d=D(u,e,c,null,void 0,void 0,r);void 0!==i&&d.setId(i),d.supportsTargetSignature()&&null!==h.signature().value()?d.setTargetSignature(h.signature().value()):d.setOwnerSource(h),d.toolname=u;const v=d.clonePositionOffset();if(t.isFixed()){const e=(0,o.ensureDefined)(t.fixedPoint()),i=n?e.add(new s.Point(v.xCoordOffset,v.yCoordOffset)):e;d.addFixedPoint(i)}const _=t.normalizedPoints(),m=n?function(e,t,n){const i=(0,o.ensureNotNull)(t.priceScale()),s=(0,
o.ensureNotNull)(t.firstValue());return e.map((e=>{const t=e.price,o=i.priceToCoordinate(t,s)+n.yCoordOffset,r=i.coordinateToPrice(o,s),l=e.interval;return{time_t:e.time_t,price:r,offset:e.offset+n.barOffset,interval:l}}))}(_,h,v):_,f=t.points();return d.restorePoints(m,f),d.cloneData&&d.cloneData(t),d.recalculateStateByData&&d.recalculateStateByData(),d}},702282:(e,t,n)=>{"use strict";n.d(t,{magnetEnabled:()=>f,magnetMode:()=>p,magnetSnapsToIndicators:()=>T,setIsMagnetEnabled:()=>g,setMagnetMode:()=>b,setMagnetSnapsToIndicators:()=>E});var i=n(294721),o=n(77294),s=n(464125),r=n(313344),l=n(772717),u=n(360425);const a=new o.WatchedValue(!1),c=new o.WatchedValue(s.MagnetMode.WeakMagnet),h=new o.WatchedValue(!1),d=(0,u.modifierPressed)(),v=(0,u.shiftPressed)();function _(){const e=d.value();if(v.value()&&(r.isToolEditingNow.value()||r.isToolCreatingNow.value()))return void a.setValue(!1);let t,n;if(r.activePointSelectionMode.value()===r.SelectPointMode.Replay)t=n=!1;else{const i=r.tool.value(),o=r.isStudyEditingNow.value()||r.activePointSelectionMode.value()===r.SelectPointMode.Study;t=e&&((0,l.isLineToolName)(i)||r.isToolEditingNow.value()||(0,r.toolIsMeasure)(i)||o),n=(0,r.properties)().childs().magnet.value()}c.setValue(!n&&t?s.MagnetMode.StrongMagnet:(0,r.properties)().childs().magnetMode.value()),a.setValue(t?!n:n)}function m(){h.setValue((0,r.properties)().childs().magnetSnapsToIndicators.value())}function f(){return a}function p(){return c}function T(){return h}function g(e){(0,i.allowSavingDefaults)(!0),(0,r.properties)().childs().magnet.setValue(e),(0,i.allowSavingDefaults)(!1)}function b(e){(0,i.allowSavingDefaults)(!0),(0,r.properties)().childs().magnetMode.setValue(e),(0,r.properties)().childs().magnet.setValue(!0),(0,i.allowSavingDefaults)(!1)}function E(e){(0,i.allowSavingDefaults)(!0),(0,r.properties)().childs().magnetSnapsToIndicators.setValue(e),(0,i.allowSavingDefaults)(!1)}(0,r.runOnDrawingStateReady)((()=>{(0,r.properties)().childs().magnet.subscribe(null,_),(0,r.properties)().childs().magnetMode.subscribe(null,_),(0,r.properties)().childs().magnetSnapsToIndicators.subscribe(null,m),d.subscribe(_),v.subscribe(_),r.tool.subscribe(_),r.isToolEditingNow.subscribe(_),_(),m()}))},300459:(e,t,n)=>{"use strict";n.d(t,{compareResolutions:()=>_.compareResolutions,convertResolutionsFromSettings:()=>L,formatDirectionalResolution:()=>A,getApplicableIntervalForFrequency:()=>_.getApplicableIntervalForFrequency,getDefaultResolution:()=>E,getMaxResolutionValue:()=>S,getResolutionByChartStyle:()=>y,getTranslatedResolution:()=>C,getTranslatedResolutionModel:()=>k,intervalIsSupported:()=>O,isAvailable:()=>g,isIntervalEnabled:()=>x,isResolutionMultiplierValid:()=>M,isSecondsEnabled:()=>N,mergeResolutions:()=>I,normalizeIntervalString:()=>T,setLastUsedResolution:()=>b,sortResolutions:()=>D});var i=n(536794),o=n(444372),s=n(666310),r=n(104779),l=n(62802),u=n(125226),a=n(625214),c=n(885148),h=n(680574),d=n(687037),v=n(840810),_=n(399072);const m=[1,5,10,15,30,45],f=[1,10,100,1e3],p=(0,u.isFeatureEnabled)("custom_ticks")
;function T(e){return s.Interval.parse(e).value()}function g(e){const t=s.Interval.parse(e);if(t.isRange())return a.linking.range.value();if(!(0,v.isTicksEnabled)()&&t.isTicks())return!1;const n=t.value(),i=a.linking.dataFrequencyResolution.value();if(void 0!==i&&(0,_.compareResolutions)(n,i)<0)return!1;const o=a.linking.supportedResolutions.value();return void 0!==o?void 0!==o.find((e=>T(e)===n)):t.isTicks()?Boolean(a.linking.ticks.value()):t.isIntraday()?Boolean(a.linking.intraday.value()):t.isDWM()}function b(e){s.Interval.isValid(e)&&(s.Interval.isRange(e)?l.setValue("chart.lastUsedRangeResolution",e):l.setValue("chart.lastUsedTimeBasedResolution",e))}function E(e){return e?"100R":"1D"}function y(e,t,n){const i=r.isRangeStyle(e),o=s.Interval.isRange(t);return!i&&o?function(e){const t=l.getValue("chart.lastUsedTimeBasedResolution");if(void 0!==t&&s.Interval.isTimeBased(t))return t;let n="1D";for(const t of e){const e=s.Interval.parse(t);if(e.isTimeBased()){const t=e.value();if("1D"===t)return t;n=t}}return n}(n):i&&!o?function(e){const t=l.getValue("chart.lastUsedRangeResolution");if(void 0!==t&&s.Interval.isRange(t))return t;let n="100R";for(const t of e){const e=s.Interval.parse(t);if(e.isRange()){const t=e.value();if("100R"===t)return t;n=t}}return n}(n):t}function M(e){const{interval:t,guiResolutionKind:n}=s.Interval.parseExt(e);if(!t.isValid())return!1;const i=t.multiplier();if(n===s.ResolutionKind.Seconds)return m.includes(i);if((0,v.isTicksEnabled)()&&n===s.ResolutionKind.Ticks)return!!p||f.includes(i);return(n===s.SpecialResolutionKind.Hours?i/60:i)<=w(n)}function w(e){const t=_.maxResolutionValues[e];return Number.isNaN(t)?1:t}function S(e){return w(s.Interval.parseExt(e).guiResolutionKind)}function L(e){return Array.isArray(e)?e:Object.keys(e).map(s.Interval.normalize).filter(i.notNull)}function I(...e){let t=[].concat(...e);return t=(0,c.uniq)(t.filter(M).map(T)),D(t)}function D(e){return e.sort(_.compareResolutions)}function C(e){const{multiplier:t,shortKind:n}=k(e);return`${t}${n}`}function k(e,t){const n=s.Interval.parse(e);let i=n.multiplier(),o=n.kind();if(!n.isValid()){if(t)return null;throw new TypeError(`Can't translate invalid interval: ${e}`)}return n.isMinuteHours()&&(i=Math.floor(i/60),o=s.SpecialResolutionKind.Hours),{multiplier:i.toString(),shortKind:P(o),hint:`${i} ${P(o,i)}`,mayOmitMultiplier:n.isDWM()&&1===i,mayOmitShortKind:n.isMinutes()&&!n.isMinuteHours()}}function P(e,t){if(!t)return{[s.ResolutionKind.Invalid]:"",[s.ResolutionKind.Ticks]:o.t(null,{context:"interval_short"},n(882901)),[s.ResolutionKind.Seconds]:o.t(null,{context:"interval_short"},n(968823)),[s.ResolutionKind.Minutes]:o.t(null,{context:"interval_short"},n(768430)),[s.SpecialResolutionKind.Hours]:o.t(null,{context:"interval_short"},n(438048)),[s.ResolutionKind.Days]:o.t(null,{context:"interval_short"},n(38691)),[s.ResolutionKind.Weeks]:o.t(null,{context:"interval_short"},n(307408)),[s.ResolutionKind.Months]:o.t(null,{context:"interval_short"},n(977995)),[s.ResolutionKind.Range]:o.t(null,{context:"interval_short"
},n(993934))}[e];switch(e){case s.ResolutionKind.Ticks:return o.t(null,{plural:"ticks",count:t},n(111913));case s.ResolutionKind.Days:return o.t(null,{plural:"days",count:t},n(641807));case s.ResolutionKind.Weeks:return o.t(null,{plural:"weeks",count:t},n(448898));case s.ResolutionKind.Months:return o.t(null,{plural:"months",count:t},n(898393));case s.ResolutionKind.Seconds:return o.t(null,{plural:"seconds",count:t},n(33232));case s.ResolutionKind.Minutes:return o.t(null,{plural:"minutes",count:t},n(378318));case s.SpecialResolutionKind.Hours:return o.t(null,{plural:"hours",count:t},n(942328));case s.ResolutionKind.Range:return o.t(null,{plural:"ranges",count:t},n(189937));default:return e}}function N(){return!0}function R(e){return!(!(0,v.isTicksEnabled)()&&e.isTicks())}function x(e){return R(s.Interval.parse(e))}function O(e){if(d.enabled("allow_supported_resolutions_set_only")){const t=s.Interval.normalize(e);return null!==t&&g(t)}{const t=s.Interval.parse(e);if(!t.isValid()||!R(t))return!1;if(!d.enabled("custom_resolutions")){const t=s.Interval.normalize(e),n=window.ChartApiInstance.defaultResolutions().filter(x);if(!t||-1===n.indexOf(t))return!1}const n=a.linking.dataFrequencyResolution.value();if(void 0!==n&&(0,_.getApplicableIntervalForFrequency)(n,t.value())!==t.value())return!1;if(t.isRange())return a.linking.range.value();if(t.isTicks())return a.linking.ticks.value();if(t.isIntraday())return a.linking.intraday.value();{const e=a.linking.supportedResolutions.value();return!e||e.includes(t.value())}}}function A(e){return(0,h.isRtl)()?" "+(0,h.forceRTLStr)(" ,"+e):", "+e}},123968:(e,t,n)=>{"use strict";var i,o;n.d(t,{AlertEditorInvocationMode:()=>o,ExpirationPresetType:()=>i}),function(e){e.OpenEnded="open-ended",e.Fixed="fixed"}(i||(i={})),function(e){e.CreateAlert="create_alert",e.EditAlert="edit_alert",e.ShowReadonlyAlert="show_alert"}(o||(o={}))},500458:(e,t,n)=>{"use strict";n.d(t,{setSupportPortalProblemsHost:()=>o,supportPortalProblemsHost:()=>i});let i="";function o(e){i=e}},890172:(e,t,n)=>{"use strict";n.r(t),n.d(t,{getTranslatedSymbolDescription:()=>s});var i=n(444372);function o(e){const t=`#${e}-symbol-description`,o=i.t(t,void 0,n(956316));return o===t?null:o}function s(e){if(void 0!==e.pro_name){const t=o(e.pro_name);if(null!==t)return t;if(void 0!==e.short_name){const t=o(e.short_name);if(null!==t)return t}}return"en"!==e.language&&void 0!==e.local_description&&e.language===window.language||"en"===e.language&&void 0!==e.local_description&&e.language===window.language?e.local_description:e.description||""}},634369:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" width="28" height="28" fill="currentColor"><path fill-rule="evenodd" d="M18 14a4 4 0 1 1-8 0 4 4 0 0 1 8 0Zm-1 0a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"/><path fill-rule="evenodd" d="M8.5 5h11l5 9-5 9h-11l-5-9 5-9Zm-3.86 9L9.1 6h9.82l4.45 8-4.45 8H9.1l-4.45-8Z"/></svg>'},201457:e=>{
e.exports='<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28"><g fill="none" fill-rule="evenodd" stroke="currentColor"><path d="M13.111 18.5H10.5a1 1 0 0 1-1-1v-11a1 1 0 0 1 1-1h11a1 1 0 0 1 1 1v11a1 1 0 0 1-1 1h-8.389z"/><path d="M18.5 20v1.5a1 1 0 0 1-1 1h-11a1 1 0 0 1-1-1v-11a1 1 0 0 1 1-1H8"/></g></svg>'}}]);